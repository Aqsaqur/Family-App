// FamilyConnect - Language Translations
// Supports English and Arabic languages

const translations = {
    en: {
        // Navigation
        home: "Home",
        family: "Family",
        photos: "Photos",
        events: "Events",
        
        // Header titles
        appTitle: "FamilyConnect",
        appSubtitle: "Bringing families together",
        familyMembers: "Family Members",
        familyPhotos: "Family Photos",
        familyEvents: "Family Events",
        
        // Dashboard
        shareMoment: "Share a moment with your family...",
        photo: "Photo",
        privacy: "Family",
        share: "Share",
        allPosts: "All Posts",
        photosFilter: "Photos",
        eventsFilter: "Events",
        updatesFilter: "Updates",
        
        // Stats
        familyMembersCount: "Family Members",
        photosShared: "Photos Shared",
        upcomingEvents: "Upcoming Events",
        totalPhotos: "Total Photos",
        albums: "Albums",
        likes: "Likes",
        
        // Posts
        justNow: "Just now",
        hoursAgo: "hours ago",
        daysAgo: "days ago",
        postShared: "Post shared with your family!",
        photoUploadComing: "Photo upload coming soon!",
        privacySettings: "Privacy settings: Family Only",
        commentsComing: "Comments feature coming soon!",
        postSharedNotification: "Post shared with family!",
        
        // Family Members
        addMember: "Add Member",
        familyTree: "Family Tree",
        adminControls: "Admin Controls",
        inviteMember: "Invite Family Member",
        manageRoles: "Manage Member Roles",
        familySettings: "Family Settings",
        searchMembers: "Search family members...",
        all: "All",
        online: "Online",
        admin: "Admins",
        recent: "Recent",
        viewProfile: "View Profile",
        message: "Message",
        posts: "posts",
        joined: "Joined",
        member: "Member",
        adminRole: "Admin",
        
        // Add Member Modal
        inviteFamilyMember: "Invite Family Member",
        name: "Name",
        email: "Email",
        relationship: "Relationship",
        sibling: "Sibling",
        parent: "Parent",
        child: "Child",
        spouse: "Spouse",
        grandparent: "Grandparent",
        grandchild: "Grandchild",
        cousin: "Cousin",
        other: "Other",
        role: "Role",
        cancel: "Cancel",
        sendInvite: "Send Invite",
        memberInvited: "has been invited to join the family!",
        
        // Relationships
        mother: "Mother",
        father: "Father",
        sister: "Sister",
        brother: "Brother",
        aunt: "Aunt",
        uncle: "Uncle",
        grandmother: "Grandmother",
        
        // Photos
        upload: "Upload",
        memoryOfTheDay: "Memory of the Day",
        photoAlbums: "Photo Albums",
        createAlbum: "Create Album",
        recentPhotos: "Recent Photos",
        viewAll: "View All",
        thisDayLastYear: "This Day Last Year",
        uploadPhotos: "Upload Photos",
        dragAndDrop: "Drag and drop photos here",
        chooseFiles: "Choose Files",
        addToAlbum: "Add to Album",
        selectAlbum: "Select an album...",
        createNewAlbum: "+ Create New Album",
        caption: "Caption (Optional)",
        addCaption: "Add a caption to your photos...",
        photosUploaded: "Photos uploaded successfully!",
        
        // Events
        createEvent: "Create Event",
        upcomingEvents: "Upcoming Events",
        familyActivity: "Family Activity",
        specialDays: "Special Days This Month",
        createFamilyEvent: "Create Family Event",
        eventTitle: "Event Title",
        dateTime: "Date & Time",
        location: "Location",
        description: "Description",
        eventType: "Event Type",
        familyGathering: "Family Gathering",
        birthday: "Birthday",
        holiday: "Holiday",
        celebration: "Celebration",
        familyMeeting: "Family Meeting",
        eventCreated: "Event created successfully!",
        rsvp: "RSVP",
        attending: "Attending",
        maybe: "Maybe",
        cantGo: "Can't Go",
        
        // Event details
        createdBy: "Created by",
        at: "at",
        
        // Special days
        birthday: "Birthday",
        anniversary: "Anniversary",
        yearsOld: "years old",
        yearsTogether: "years together",
        
        // Notifications
        comingSoon: "coming soon!",
        profileViewComing: "Viewing profile coming soon!",
        messageComing: "Message coming soon!",
        roleManagementComing: "Role management coming soon!",
        settingsComing: "Family settings coming soon!",
        albumCreationComing: "Create album feature coming soon!",
        allPhotosViewComing: "All photos view coming soon!",
        
        // Days of week
        sun: "Sun",
        mon: "Mon",
        tue: "Tue",
        wed: "Wed",
        thu: "Thu",
        fri: "Fri",
        sat: "Sat",
        
        // Months
        january: "January",
        february: "February",
        march: "March",
        april: "April",
        may: "May",
        june: "June",
        july: "July",
        august: "August",
        september: "September",
        october: "October",
        november: "November",
        december: "December"
    },
    ar: {
        // Navigation
        home: "الرئيسية",
        family: "العائلة",
        photos: "الصور",
        events: "الفعاليات",
        
        // Header titles
        appTitle: "كونيكت العائلة",
        appSubtitle: "جمع العائلات معاً",
        familyMembers: "أعضاء العائلة",
        familyPhotos: "صور العائلة",
        familyEvents: "فعاليات العائلة",
        
        // Dashboard
        shareMoment: "شارك لحظة مع عائلتك...",
        photo: "صورة",
        privacy: "العائلة",
        share: "مشاركة",
        allPosts: "جميع المنشورات",
        photosFilter: "الصور",
        eventsFilter: "الفعاليات",
        updatesFilter: "التحديثات",
        
        // Stats
        familyMembersCount: "أعضاء العائلة",
        photosShared: "الصور المشتركة",
        upcomingEvents: "الفعاليات القادمة",
        totalPhotos: "إجمالي الصور",
        albums: "الألبومات",
        likes: "الإعجابات",
        
        // Posts
        justNow: "الآن",
        hoursAgo: "منذ ساعات",
        daysAgo: "منذ أيام",
        postShared: "تم مشاركة المنشور مع عائلتك!",
        photoUploadComing: "تحميل الصور قريباً!",
        privacySettings: "إعدادات الخصوصية: العائلة فقط",
        commentsComing: "ميزة التعليقات قريباً!",
        postSharedNotification: "تم مشاركة المنشور مع العائلة!",
        
        // Family Members
        addMember: "إضافة عضو",
        familyTree: "شجرة العائلة",
        adminControls: "ضوابط المسؤول",
        inviteMember: "دعوة عضو عائلة",
        manageRoles: "إدارة أدوار الأعضاء",
        familySettings: "إعدادات العائلة",
        searchMembers: "بحث عن أعضاء العائلة...",
        all: "الكل",
        online: "متصل",
        admin: "المسؤولون",
        recent: "الحديثة",
        viewProfile: "عرض الملف",
        message: "رسالة",
        posts: "منشورات",
        joined: "انضم",
        member: "عضو",
        adminRole: "مسؤول",
        
        // Add Member Modal
        inviteFamilyMember: "دعوة عضو عائلة",
        name: "الاسم",
        email: "البريد الإلكتروني",
        relationship: "العلاقة",
        sibling: "أخ/أخت",
        parent: "أب/أم",
        child: "ابن/ابنة",
        spouse: "زوج/زوجة",
        grandparent: "جد/جدة",
        grandchild: "حفيد/حفيدة",
        cousin: "ابن عم/ابنة عم",
        other: "أخرى",
        role: "الدور",
        cancel: "إلغاء",
        sendInvite: "إرسال دعوة",
        memberInvited: "تمت دعوته للانضمام إلى العائلة!",
        
        // Relationships
        mother: "أم",
        father: "أب",
        sister: "أخت",
        brother: "أخ",
        aunt: "عمة/خالة",
        uncle: "عم/خال",
        grandmother: "جدة",
        
        // Photos
        upload: "تحميل",
        memoryOfTheDay: "ذكرى اليوم",
        photoAlbums: "ألبومات الصور",
        createAlbum: "إنشاء ألبوم",
        recentPhotos: "الصور الحديثة",
        viewAll: "عرض الكل",
        thisDayLastYear: "في هذا اليوم من العام الماضي",
        uploadPhotos: "تحميل الصور",
        dragAndDrop: "اسحب وأفلت الصور هنا",
        chooseFiles: "اختر ملفات",
        addToAlbum: "إضافة إلى الألبوم",
        selectAlbum: "اختر ألبوماً...",
        createNewAlbum: "+ إنشاء ألبوم جديد",
        caption: "الشرح (اختياري)",
        addCaption: "أضف شرحاً لصورك...",
        photosUploaded: "تم تحميل الصور بنجاح!",
        
        // Events
        createEvent: "إنشاء فعالية",
        upcomingEvents: "الفعاليات القادمة",
        familyActivity: "نشاط العائلة",
        specialDays: "الأيام الخاصة هذا الشهر",
        createFamilyEvent: "إنشاء فعالية عائلية",
        eventTitle: "عنوان الفعالية",
        dateTime: "التاريخ والوقت",
        location: "الموقع",
        description: "الوصف",
        eventType: "نوع الفعالية",
        familyGathering: "تجمع عائلي",
        birthday: "عيد ميلاد",
        holiday: "عطلة",
        celebration: "احتفال",
        familyMeeting: "اجتماع عائلي",
        eventCreated: "تم إنشاء الفعالية بنجاح!",
        rsvp: "الحضور",
        attending: "حاضر",
        maybe: "ربما",
        cantGo: "لا أستطيع الذهاب",
        
        // Event details
        createdBy: "تم الإنشاء بواسطة",
        at: "في",
        
        // Special days
        birthday: "عيد ميلاد",
        anniversary: "ذكرى سنوية",
        yearsOld: "سنة",
        yearsTogether: "سنة معاً",
        
        // Notifications
        comingSoon: "قريباً!",
        profileViewComing: "عرض الملف الشخصي قريباً!",
        messageComing: "المراسلة قريباً!",
        roleManagementComing: "إدارة الأدوار قريباً!",
        settingsComing: "إعدادات العائلة قريباً!",
        albumCreationComing: "ميزة إنشاء الألبومات قريباً!",
        allPhotosViewComing: "عرض جميع الصور قريباً!",
        
        // Days of week
        sun: "الأحد",
        mon: "الاثنين",
        tue: "الثلاثاء",
        wed: "الأربعاء",
        thu: "الخميس",
        fri: "الجمعة",
        sat: "السبت",
        
        // Months
        january: "يناير",
        february: "فبراير",
        march: "مارس",
        april: "أبريل",
        may: "مايو",
        june: "يونيو",
        july: "يوليو",
        august: "أغسطس",
        september: "سبتمبر",
        october: "أكتوبر",
        november: "نوفمبر",
        december: "ديسمبر"
    }
};

// Language management class
class LanguageManager {
    constructor() {
        this.currentLang = localStorage.getItem('familyConnectLang') || 'ar'; // Default to Arabic
        this.isRTL = this.currentLang === 'ar';
        this.init();
    }
    
    init() {
        this.applyLanguage();
        this.updateDirection();
        this.setupLanguageSwitcher();
    }
    
    setLanguage(lang) {
        if (!translations[lang]) {
            console.warn(`Language ${lang} not supported`);
            return;
        }
        
        this.currentLang = lang;
        this.isRTL = lang === 'ar';
        localStorage.setItem('familyConnectLang', lang);
        this.applyLanguage();
        this.updateDirection();
        
        // Show notification
        this.showLanguageChangeNotification();
    }
    
    getCurrentLang() {
        return this.currentLang;
    }
    
    getTranslation(key) {
        const translation = translations[this.currentLang][key];
        if (!translation) {
            console.warn(`Translation missing for key: "${key}" in language: "${this.currentLang}"`);
            return translations['en'][key] || key;
        }
        return translation;
    }
    
    applyLanguage() {
        // Apply translations to elements with data-translate attribute
        const elements = document.querySelectorAll('[data-translate]');
        elements.forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = this.getTranslation(key);
            
            if (element.tagName === 'INPUT' && element.type !== 'button') {
                element.placeholder = translation;
            } else if (element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else if (element.hasAttribute('title')) {
                element.title = translation;
            } else if (element.hasAttribute('aria-label')) {
                element.setAttribute('aria-label', translation);
            } else {
                element.textContent = translation;
            }
        });
        
        // Update any dynamic content
        this.translateDynamicContent();
    }
    
    updateDirection() {
        document.documentElement.setAttribute('dir', this.isRTL ? 'rtl' : 'ltr');
        document.documentElement.setAttribute('lang', this.currentLang);
        
        // Update body classes for RTL styling
        if (this.isRTL) {
            document.body.classList.add('rtl');
            document.body.classList.remove('ltr');
        } else {
            document.body.classList.add('ltr');
            document.body.classList.remove('rtl');
        }
    }
    
    setupLanguageSwitcher() {
        // Create language switcher if it doesn't exist
        let switcher = document.getElementById('languageSwitcher');
        if (!switcher) {
            switcher = document.createElement('div');
            switcher.id = 'languageSwitcher';
            switcher.className = 'language-switcher fixed top-4 right-4 z-50';
            switcher.innerHTML = `
                <div class="bg-white rounded-lg shadow-lg p-2 flex space-x-2">
                    <button class="lang-btn px-3 py-1 rounded text-sm font-medium transition-all ${
                        this.currentLang === 'ar' ? 'bg-warm-sage text-white' : 'bg-gray-100 text-gray-700'
                    }" data-lang="ar">العربية</button>
                    <button class="lang-btn px-3 py-1 rounded text-sm font-medium transition-all ${
                        this.currentLang === 'en' ? 'bg-warm-sage text-white' : 'bg-gray-100 text-gray-700'
                    }" data-lang="en">English</button>
                </div>
            `;
            
            document.body.appendChild(switcher);
            
            // Add event listeners
            switcher.addEventListener('click', (e) => {
                if (e.target.classList.contains('lang-btn') && e.target.dataset.lang) {
                    this.setLanguage(e.target.dataset.lang);
                }
            });
        }
    }
    
    translateDynamicContent() {
        // This function can be called when new content is dynamically added to the page
        // For now, it re-applies translations to all elements
        this.applyLanguage();
    }
    
    showLanguageChangeNotification() {
        const message = this.currentLang === 'ar' 
            ? 'تم تغيير اللغة إلى العربية' 
            : 'Language changed to English';
        
        // Use the existing notification system if available
        if (window.FamilyConnect && typeof window.FamilyConnect.showNotification === 'function') {
            window.FamilyConnect.showNotification(message);
        } else {
            // Fallback notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 left-4 right-4 bg-warm-sage text-white p-4 rounded-lg shadow-lg z-50 transform translate-y-[-100px] transition-transform duration-300';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-y-[-100px]');
                notification.classList.add('translate-y-0');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-y-[-100px]');
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    }
    
    // Utility function to format numbers based on language
    formatNumber(number) {
        if (this.currentLang === 'ar') {
            // Convert to Arabic numerals
            const arabicNumerals = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
            return number.toString().replace(/\d/g, digit => arabicNumerals[parseInt(digit)]);
        }
        return number.toString();
    }
    
    // Utility function to format dates based on language
    formatDate(dateString) {
        const date = new Date(dateString);
        if (this.currentLang === 'ar') {
            return date.toLocaleDateString('ar-EG');
        }
        return date.toLocaleDateString('en-US');
    }
}

// Initialize language manager
const languageManager = new LanguageManager();

// Function to translate specific text (useful for JavaScript-generated content)
function translate(key) {
    return languageManager.getTranslation(key);
}

// Function to update translations when new content is added
function updateTranslations() {
    languageManager.translateDynamicContent();
}

// Export for use in other files
window.LanguageManager = languageManager;
window.translations = translations;
window.translate = translate;
window.updateTranslations = updateTranslations;

// Auto-initialize when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    // Language manager is already initialized in constructor
    console.log('FamilyConnect Translations loaded - Current language:', languageManager.getCurrentLang());
});

// Add some basic CSS for the language switcher
const style = document.createElement('style');
style.textContent = `
    .language-switcher .lang-btn {
        transition: all 0.3s ease;
    }
    .language-switcher .lang-btn:hover {
        transform: scale(1.05);
    }
    .rtl .language-switcher {
        right: auto;
        left: 1rem;
    }
`;
document.head.appendChild(style);